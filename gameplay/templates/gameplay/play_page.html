<!DOCTYPE html>
<html>
<head>
    <title>Playing Story</title>
    <style>
        .dialogue-box { border: 1px solid #ccc; padding: 15px; margin-bottom: 20px; border-radius: 8px; }
        .speaker { font-weight: bold; color: #333; margin-bottom: 5px; }
        .text { font-size: 1.1em; line-height: 1.5; }
        .choice-btn { display: block; margin: 10px 0; padding: 10px; background: #eee; text-decoration: none; color: black; border-radius: 4px; }
        .choice-btn:hover { background: #ddd; }
        .effect { font-size: 0.8em; color: #666; margin-left: 10px; }
    </style>
</head>
<body>
    <div class="story-container">

        {% if node.background %}
            <p><em>Scene: {{ node.background }}</em></p>
        {% endif %}

        {% for line in node.content %}
            <div class="dialogue-box">
                {% if line.speaker %}
                    <div class="speaker">{{ line.speaker }}</div>
                {% endif %}
                <div class="text">{{ line.text }}</div>
            </div>
        {% endfor %}

        <hr>

        {% if node.is_ending %}
            <div class="ending-screen">
                <h2>THE END</h2>
                {% if node.outcome %}
                    <h3>Result: {{ node.outcome }}</h3>
                {% endif %}
                <a href="{% url 'story_list' %}">Back to Story List</a>
            </div>
        {% else %}
            <div class="choices">
                <h3>What do you want to do?</h3>
                {% for choice in node.choices %}
                    <a class="choice-btn" href="{% url 'play_node' story_id=story_id node_id=choice.target_node %}">
                        {{ choice.label }}

                        {% if choice.effect %}
                            <span class="effect">({{ choice.effect }})</span>
                        {% endif %}
                    </a>
                {% endfor %}
            </div>
        {% endif %}
    </div>
</body>
</html>